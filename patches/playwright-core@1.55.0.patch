diff --git a/lib/server/utils/nodePlatform.js b/lib/server/utils/nodePlatform.js
index 80d88fedf2c4d2b7bea8cfd4b9c8db454dedaa1d..238c729a546e4a498015a2d6d6d1481d7a34c87d 100644
--- a/lib/server/utils/nodePlatform.js
+++ b/lib/server/utils/nodePlatform.js
@@ -64,7 +64,14 @@ let boxedStackPrefixes = [];
 function setBoxedStackPrefixes(prefixes) {
   boxedStackPrefixes = prefixes;
 }
-const coreDir = import_path.default.dirname(require.resolve("../../../package.json"));
+let coreDir;
+try {
+  coreDir = import_path.default.dirname(
+    require.resolve("playwright-core/package.json"),
+  );
+} catch {
+  coreDir = import_path.default.resolve(__dirname, "../../..");
+}
 const nodePlatform = {
   name: "node",
   boxedStackPrefixes: () => {
